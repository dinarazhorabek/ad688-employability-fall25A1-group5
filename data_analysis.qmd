---
title: "Data Analysis"
subtitle: "Cleaning, Exploration, and Patterns in the 2024 Job Market"
bibliography: references.bib
csl: csl/econometrica.csl
format:
  html:
    toc: true
    code-fold: true
    code-tools: true
---

<div class="card reveal">

## Data Sources

Describe Lightcast + FRED here.

</div>

<div class="card reveal">

## Cleaning Pipeline

```{python}
#| output: false
import pandas as pd
import re

import plotly.express as px
import plotly.graph_objects as go
```
```{python}
#| warning: false
# Your cleaning code

lightcast_jp = pd.read_csv('data/lightcast_job_postings.csv')
```
</div>

<div class="card reveal">

## Skill Gap Analysis

```{python}
team_members = ["Dinara", "Nhat", "Leo"]
skills = [
    "SQL (Programming Language)",
    "Python (Programming Language)",
    "Tableau (Business Intelligence Software)",
    "Power BI",
    "Microsoft Excel",
    "R (Programming Language)",
    "Amazon Web Services",
]
df_skills = pd.DataFrame(
    {
        "Name": team_members,
        "SQL (Programming Language)": [5, 3, 4],
        "Python (Programming Language)": [4, 3, 5],
        "Tableau (Business Intelligence Software)": [3, 4, 2],
        "Power BI": [2, 5, 3],
        "Microsoft Excel": [5, 4, 4],
        "R (Programming Language)": [2, 1, 3],
        "Amazon Web Services": [4, 4, 4],
    }
).set_index("Name")
```


```{python}
fig_heat = px.imshow(
    df_skills,
    text_auto=True,
    aspect="auto",
    color_continuous_scale="Blues",
    labels=dict(color="Skill Level"),
    title="Team Skill Matrix"
)
fig_heat.update_yaxes(title="Team Member")
fig_heat
```

### Gaps Between Team Strengths and Industry Demand

```{python}
naics_data_industries = [51, 52, 54]
df_data_industry = lightcast_jp[ lightcast_jp["NAICS2"].astype(float).isin(naics_data_industries) ]

data_keywords = ["data", "analytics", "analysis", "machine learning", "ml", "ai", 
                 "business intelligence", "cloud", "sql", "python"]
df_data_roles = lightcast_jp[
    lightcast_jp["TITLE_NAME"].str.lower().str.contains('|'.join(data_keywords), na=False)
]
# merge of two tables -> industry + title
df_filtered = df_data_industry[
    df_data_industry["TITLE_NAME"].str.lower().str.contains('|'.join(data_keywords))
]
```

```{python}
# Extract everything between quotes
df_filtered = df_filtered.copy()
df_filtered["software_skill"] = (
    df_filtered["SOFTWARE_SKILLS_NAME"]
        .fillna("")                     # remove NaN
        .str.replace("\n", "")          # remove newlines
        .apply(lambda x: re.findall(r'"(.*?)"', x))
)
df_sw_exploded = (
    df_filtered
        .explode("software_skill")
        .dropna(subset=["software_skill"])
)
# count demand per skill
industry_skill_counts = (
    df_sw_exploded["software_skill"]
        .value_counts()
        .to_frame(name="count")
)
industry_skill_counts.head()
```

```{python}
# average team level per skill
team_avg = df_skills.mean().to_frame(name="Team_Level")
ind_skills = industry_skill_counts.rename_axis("Skill")
ind_skills = ind_skills.loc[skills]

gap_df = team_avg.join(ind_skills, how="left")

# normalize industry demand to 1–5 scale
max_demand = gap_df["count"].max()
gap_df["Industry_Score"] = (gap_df["count"] / max_demand) * 5

# gap = industry need – team level
gap_df["Gap"] = gap_df["Industry_Score"] - gap_df["Team_Level"]
gap_df
```


```{python}
gap_long = (
    gap_df[["Team_Level", "Industry_Score"]]
    .reset_index(names="Skill")
    .melt(id_vars="Skill", var_name="Source", value_name="Score")
)
fig_gap = px.bar(
    gap_long,
    x="Score",
    y="Skill",
    color="Source",
    barmode="group",
    orientation="h",
    title="Skills Gap Analysis",
    labels={"Score": "Score (1–5)", "Skill": "", "Source": ""}
)
fig_gap.update_layout(
    legend_title_text="",
    xaxis=dict(range=[0, 5]),
)
fig_gap.update_layout(
    legend=dict(
        orientation="v",
        yanchor="top",
        y=1,
        xanchor="left",
        x=0.75
    )
)
fig_gap
```


```{python}
skills_list = gap_df.index.tolist()
team_values = gap_df["Team_Level"].tolist()
industry_values = gap_df["Industry_Score"].tolist()

skills_list += [skills_list[0]]
team_values += [team_values[0]]
industry_values += [industry_values[0]]

fig = go.Figure()
fig.add_trace(go.Scatterpolar(
    r=team_values,
    theta=skills_list,
    fill='toself',
    name='Team Level',
    line=dict(color='rgba(44, 127, 184, 0.9)', width=3),
    fillcolor='rgba(44, 127, 184, 0.3)'
))
fig.add_trace(go.Scatterpolar(
    r=industry_values,
    theta=skills_list,
    fill='toself',
    name='Industry Demand',
    line=dict(color='rgba(255, 127, 14, 0.9)', width=3),
    fillcolor='rgba(255, 127, 14, 0.3)'
))

fig.update_layout(
    title="Skill Gap Analysis",
    polar=dict(
        radialaxis=dict(visible=True, range=[0, 5]),
    ),
    showlegend=True,
    legend=dict(orientation="h", y=-0.2)
)
fig.show()
```

</div>