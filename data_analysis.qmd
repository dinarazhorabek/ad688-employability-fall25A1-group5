---
title: "Data Analysis"
subtitle: "Cleaning, Exploration, and Patterns in the 2024 Job Market"
bibliography: references.bib
csl: csl/econometrica.csl
format:
  html:
    toc: true
---

<div class="card reveal">

## Data Sources

Describe Lightcast + FRED here.

</div>

<div class="card reveal">

## Cleaning Pipeline

```{python}
# Your cleaning code
import pandas as pd

lightcast_jp = pd.read_csv('data/lightcast_job_postings.csv')
```
<!-- </div> -->

<!-- <div class="card reveal"> -->
## Skill Gap Analysis

```{python}
team_members = ["Dinara", "Nhat", "Leo"]
skills = [
    "SQL (Programming Language)",
    "Python (Programming Language)",
    "Tableau (Business Intelligence Software)",
    "Power BI",
    "Microsoft Excel",
    "R (Programming Language)",
    "Amazon Web Services",
]
df_skills = pd.DataFrame(
    {
        "Name": team_members,
        "SQL (Programming Language)": [5, 3, 4],
        "Python (Programming Language)": [4, 3, 5],
        "Tableau (Business Intelligence Software)": [3, 4, 2],
        "Power BI": [2, 5, 3],
        "Microsoft Excel": [5, 4, 4],
        "R (Programming Language)": [2, 1, 3],
        "Amazon Web Services": [4, 4, 4],
    }
).set_index("Name")
print(df_skills)
```


```{python}
import seaborn as sns
import matplotlib.pyplot as plt

plt.figure(figsize=(8, 6))
sns.heatmap(df_skills, annot=True, cmap="coolwarm", linewidths=0.5)
plt.title("Team Skill Levels Heatmap")
plt.show()
```


```{python}
naics_data_industries = [51, 52, 54]
df_data_industry = lightcast_jp[ lightcast_jp["NAICS2"].astype(float).isin(naics_data_industries) ]

data_keywords = ["data", "analytics", "analysis", "machine learning", "ml", "ai", 
                 "business intelligence", "cloud", "sql", "python"]
df_data_roles = lightcast_jp[
    lightcast_jp["TITLE_NAME"].str.lower().str.contains('|'.join(data_keywords), na=False)
]
# merge of two tables -> industry + title
df_filtered = df_data_industry[
    df_data_industry["TITLE_NAME"].str.lower().str.contains('|'.join(data_keywords))
]
```


```{python}
import re
# Extract everything between quotes
df_filtered["SW_LIST"] = (
    df_filtered["SOFTWARE_SKILLS_NAME"]
        .fillna("")                     # remove NaN
        .str.replace("\n", "")          # remove newlines
        .apply(lambda x: re.findall(r'"(.*?)"', x))
)
df_sw_exploded = (
    df_filtered
        .explode("SW_LIST")
        .dropna(subset=["SW_LIST"])
)
# count demand per skill
industry_skill_counts = (
    df_sw_exploded["SW_LIST"]
        .value_counts()
        .to_frame(name="Demand_Count")
)
industry_skill_counts.head()
```

```{python}
# average team level per skill
team_avg = df_skills.mean().to_frame(name="Team_Level")
ind_skills = industry_skill_counts.rename_axis("Skill")
ind_skills = ind_skills.loc[skills]

gap_df = team_avg.join(ind_skills, how="left")

# normalize industry demand to 1–5 scale
max_demand = gap_df["Demand_Count"].max()
gap_df["Industry_Score"] = (gap_df["Demand_Count"] / max_demand) * 5

# gap = industry need – team level
gap_df["Gap"] = gap_df["Industry_Score"] - gap_df["Team_Level"]
print(gap_df)
```


```{python}
import plotly.express as px

gap_long = (
    gap_df[["Team_Level", "Industry_Score"]]
    .reset_index(names="Skill")
    .melt(id_vars="Skill", var_name="Source", value_name="Score")
)
fig_gap = px.bar(
    gap_long,
    x="Score",
    y="Skill",
    color="Source",
    barmode="group",
    orientation="h",
    title="Skills Gap Analysis",
    labels={"Score": "Score (1–5)", "Skill": "", "Source": ""}
)
fig_gap.update_layout(
    legend_title_text="",
    xaxis=dict(range=[0, 5]),
)
fig_gap
```


```{python}
import plotly.express as px

fig_heat = px.imshow(
    df_skills,
    text_auto=True,
    aspect="auto",
    color_continuous_scale="Blues",
    labels=dict(color="Skill Level"),
    title="Team Skill Matrix (Top Industry Skills)"
)
fig_heat.update_yaxes(title="Team Member")
fig_heat
```

<!-- </div> -->